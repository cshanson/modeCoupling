# Helioseismic Mode Coupling Code
This code was used to produce the local helioseismic mode coupling results from Hanson et al. 2024. Details on the mathematics and processing pipeline can be found in the paper. The basic input data are HMI Doppler and HMI continuum cubes generated by [mtrack](http://hmi.stanford.edu/rings/modules/mtrack.html).


## Before you begin
After pulling the source code from this github, you need to download sample data from google drive (use this [link](https://drive.google.com/drive/folders/13lIBD0p3wGTSTvqFZroX7vfdPhta8qrd?usp=sharing)). The contents of the drive folder should be at the same level as the git repository. Specifically:

>DATA/ # contains Doppler and Continuum cubes
>
>eigenfunctions_combined/ # contains eigenfunctions from GYRE
>
>eigs/ # Contains eigenfunctions from A. Birch
>
>modeCoupling/ # This git repository

The python conda environment can be produced using the [yml file](modeCouple.yml) in the git reposititory.

## Running the code
We have included a number of scripts that are designed to be run in sequence to produce processed data. You can find the Scripts [here](Scripts/). Details of what each script does can be found in the header of those files. You will need to specify relative paths in the file 0_0_Initialize.py, then run this file before running the remaining scripts. 

**Note:** some scripts are very computationally heavy (RAM > 500Gb needed for scripts beginning with 4 or 5), we recommend running these codes on a HPC system.

## Referencing
Users who wish to use this code in publications should reference:

[Hanson et al. 2022](https://ui.adsabs.harvard.edu/abs/2021ApJ...910..156H/abstract),
[Mani et al. 2022](https://ui.adsabs.harvard.edu/abs/2022ApJ...926..127M/abstract),
[Das 2022](https://ui.adsabs.harvard.edu/abs/2022ApJ...940...92D/abstract),
Hanson et al. 2024


## Acknowledgements
Some parts of the core routines were developed by Damien Fournier (Bspline Basis routines) and Michael Leguebe (ParallelTools).
